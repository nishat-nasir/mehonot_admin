import 'package:auto_route/auto_route.dart';import 'package:mehonot_admin/manager/models/User/user_profile_md.dart';import 'package:mehonot_admin/manager/navigation/router.gr.dart';import 'package:mehonot_admin/presentation/utils/constants.dart';import '../../../manager/models/Job/job_dtl_md.dart';import '../../../manager/models/Job/job_md.dart';import '../../../manager/redux/states/jobs_state.dart';import '../../../manager/redux/states/user_state.dart';import '../../template/template.dart';import 'job_details_view.dart';@RoutePage(name: "JobDetailsRouter")class JobDetailsPage extends StatefulWidget {  final JobModel jobModel;  JobDetailModel? jobDetailModel;  JobDetailsPage({    Key? key,    required this.jobModel,    this.jobDetailModel,  }) : super(key: key);  @override  State<JobDetailsPage> createState() => _JobDetailsPageState();}class _JobDetailsPageState extends State<JobDetailsPage> {  bool isLoading = true;  late JobDetailModel jobDetailModel;  bool isSavingOrNot = false;  bool isJobSavedOrNot = false;  @override  void initState() {    super.initState();    WidgetsBinding.instance.addPostFrameCallback((_) async {      _callJobDetailsApi();      UserProfileModel userProfileModel =          appStore.state.userState.userProfileData;      if (userProfileModel.savedJobsIds != null &&          userProfileModel.savedJobsIds!.isNotEmpty) {        isJobSavedOrNot =            userProfileModel.savedJobsIds!.contains(widget.jobModel.jobId);      } else {        isJobSavedOrNot = false;      }    });  }  @override  Widget build(BuildContext context) {    return isLoading        ? SizedBox(            height: MediaQuery.of(context).size.height,            child: Center(                child: SizedBox(                    height: 50,                    width: 50,                    child: CircularProgressIndicator(                      color: Theme.of(context).colorScheme.primary,                    ))))        : JobDetailsView(            jobModel: widget.jobModel,            jobDetailModel: jobDetailModel,            iconList: [              HeroIcons.paperAirplane,              HeroIcons.phoneArrowUpRight,              isJobSavedOrNot ? HeroIcons.bookmarkSquare : HeroIcons.bookmark            ],            onPress1: () => logger(                "Send Message to this owner of this job : ${widget.jobModel.companyName}"),            onPress2: () => context.pushRoute(CeoJobEditRouter(                  jobDetailModel: jobDetailModel,                  jobModel: widget.jobModel,                )),            onPress3: () async {              setState(() {                isSavingOrNot = true;              });              bool success = await appStore.dispatch(GetUpdateSavedJobsAction(                jobData: widget.jobModel,              ));              setState(() {                if (success) {                  isJobSavedOrNot = !isJobSavedOrNot;                }                isSavingOrNot = false;              });            });  }  _callJobDetailsApi() async {    if (widget.jobDetailModel != null) {      return;    }    String jobId = widget.jobModel.jobId;    String jobDetailsId = widget.jobModel.jobDetailsId;    Division jobDivision =        convertStringToDivision(widget.jobModel.address.division);    bool success = await appStore.dispatch(GetJobDetailsAction(        division: jobDivision, jobId: jobId, jobDetailsId: jobDetailsId));    logger(appStore.state.jobsState.selectedJobDetailModel.toJson(),        hint: "selectedJobDetailModel__title");    if (success) {      setState(() {        jobDetailModel = appStore.state.jobsState.selectedJobDetailModel;        isLoading = false;      });    }  }}